(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[440],{4539:function(e,t,r){Promise.resolve().then(r.bind(r,9973))},9973:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var s=r(7437),a=r(4693),i=r(6013),n=r(9135);function d(e){let{missions:t,progress:r}=e,d=new Map(r.map(e=>[e.mission_id,e]));return(0,s.jsx)("div",{className:"du-grid two",children:t.map(e=>{var t,r,o;let l=d.get(e.id);return(0,s.jsxs)(i.Z,{title:e.title,badge:(0,s.jsxs)(a.C,{children:["Order #",null!==(t=e.order_in_story)&&void 0!==t?t:"â€”"]}),children:[(0,s.jsx)("p",{className:"du-meta",children:e.description}),(0,s.jsxs)("div",{className:"du-chip-row",children:[(0,s.jsxs)(n.A,{children:["Reward: ",null!==(r=e.reward_cc)&&void 0!==r?r:0," CC"]}),e.reward_item?(0,s.jsxs)(n.A,{children:["Item: ","string"==typeof e.reward_item?e.reward_item:"Reward item"]}):null,(0,s.jsxs)(n.A,{children:["Difficulty: ",null!==(o=e.mission_difficulty)&&void 0!==o?o:1]}),e.is_battle?(0,s.jsx)(n.A,{children:"Battle mission"}):(0,s.jsx)(n.A,{children:"Story"})]}),(0,s.jsxs)("div",{className:"du-chip-row",style:{marginTop:8},children:[(0,s.jsx)(a.C,{children:"Progress"}),(0,s.jsx)(n.A,{children:(null==l?void 0:l.is_completed)?"Completed":"In progress"}),(null==l?void 0:l.completion_date)?(0,s.jsxs)(n.A,{children:["Done at ",l.completion_date]}):null,e.trainer_id?(0,s.jsxs)(n.A,{children:["Trainer: ",e.trainer_id]}):null]})]},e.id)})})}var o=r(371);function l(){let e=(0,o.G)();return(0,s.jsxs)("div",{className:"du-stack",children:[(0,s.jsx)(i.Z,{title:"Missions",badge:(0,s.jsx)(n.A,{children:e.missions.length}),children:(0,s.jsx)("p",{className:"du-meta",children:"Story and region-based missions; unlock new regions/creatures; rewards in CC and items."})}),(0,s.jsx)(d,{missions:e.missions,progress:e.missionProgress})]})}},4693:function(e,t,r){"use strict";r.d(t,{C:function(){return a}});var s=r(7437);function a(e){let{children:t}=e;return(0,s.jsx)("span",{className:"du-badge",children:t})}},6013:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var s=r(7437);function a(e){let{children:t,title:r,badge:a,footer:i,className:n}=e;return(0,s.jsxs)("div",{className:["du-card",n].filter(Boolean).join(" "),children:[(r||a)&&(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r?(0,s.jsx)("h3",{style:{margin:0},children:r}):(0,s.jsx)("span",{}),a]}),t,i?(0,s.jsx)("div",{style:{marginTop:10},children:i}):null]})}},9135:function(e,t,r){"use strict";r.d(t,{A:function(){return a}});var s=r(7437);function a(e){let{children:t,className:r,style:a,variant:i}=e;return(0,s.jsx)("span",{className:["du-tag","ghost"===i?"du-tag--ghost":null,r].filter(Boolean).join(" "),style:a,children:t})}},857:function(e,t,r){"use strict";r.d(t,{H:function(){return d},a:function(){return o}});var s=r(7437),a=r(2265),i=r(1180);let n=(0,a.createContext)({userId:null,status:"loading",signOut:async()=>{}});function d(e){let{children:t}=e,r=(0,i.O)(),[d,o]=(0,a.useState)(null),[l,u]=(0,a.useState)(r?"loading":"signed_out"),[c,_]=(0,a.useState)(void 0);(0,a.useEffect)(()=>{if(!r){u("signed_out");return}let e=!1;(async()=>{var t;let{data:s,error:a}=await r.auth.getSession();if(!e){if(a){try{await r.auth.signOut()}catch(e){}u("signed_out"),_(a.message),o(null)}else(null===(t=s.session)||void 0===t?void 0:t.user)?(o(s.session.user.id),u("ready")):u("signed_out")}})();let{data:t}=r.auth.onAuthStateChange((e,t)=>{(null==t?void 0:t.user)?(o(t.user.id),u("ready")):(o(null),u("signed_out"))});return()=>{e=!0,null==t||t.subscription.unsubscribe()}},[r]);let m=async()=>{r&&(await r.auth.signOut(),o(null),u("signed_out"))};return(0,s.jsx)(n.Provider,{value:{userId:d,status:l,error:c,signOut:m},children:t})}function o(){return(0,a.useContext)(n)}},371:function(e,t,r){"use strict";r.d(t,{G:function(){return l},U:function(){return o}});var s=r(7437),a=r(2265),i=r(1180),n=r(857);let d=(0,a.createContext)({regions:[],creatures:[],creatureStages:[],playerCreatures:[],regionCreatures:[],cityCreatures:[],missions:[],missionProgress:[],achievements:[],userAchievements:[],bonds:[],battles:[],profile:null,trainerStats:[],playerStats:[],xpThresholds:[],factions:[],cities:[],status:"idle",isLive:!1,reload:async()=>{}});function o(e){let{children:t}=e,r=(0,i.O)(),{userId:o,status:l}=(0,n.a)(),[u,c]=(0,a.useState)("idle"),[_,m]=(0,a.useState)(void 0),[f,p]=(0,a.useState)([]),[g,h]=(0,a.useState)([]),[y,v]=(0,a.useState)([]),[x,j]=(0,a.useState)([]),[S,w]=(0,a.useState)([]),[b,C]=(0,a.useState)([]),[k,q]=(0,a.useState)([]),[N,A]=(0,a.useState)([]),[O,T]=(0,a.useState)([]),[P,E]=(0,a.useState)([]),[I,B]=(0,a.useState)([]),[D,M]=(0,a.useState)([]),[R,Z]=(0,a.useState)([]),[G,U]=(0,a.useState)(null),[F,H]=(0,a.useState)(!1),[J,L]=(0,a.useState)([]),[X,z]=(0,a.useState)([]),[K,Q]=(0,a.useState)([]),[V,W]=(0,a.useState)([]),Y=async()=>{if(!r||!o){c("idle"),H(!1);return}c("loading"),m(void 0);let e=[],[t,s,a,i,n,d,l,u,_,f,g,y,x,S,b,k,N,O]=await Promise.all([r.from("profiles").select("*").eq("id",o).maybeSingle(),r.from("creatures").select("id, name, name_locales, base_type, region, image_url, is_starter, rarity, sexes"),r.from("creature_stages").select("id, creature_id, stage_name, stage_order, stage_stats, image_url, image_url_male, image_url_female, variant_type, xp_required"),r.from("player_creatures").select("user_id, creature_id, current_stage_id, nickname, variant_type, date_caught, custom_stats, current_xp, level, in_party, party_slot, is_domesticated, stats, sex").eq("user_id",o),r.from("regions").select("id, name, color, island, municipalities, map_polygon"),r.from("region_creatures").select("region_id, creature_id, spawn_rate"),r.from("cities").select("id, name, region_id"),r.from("city_creatures").select("city_id, creature_id, spawn_rate"),r.from("story_missions").select("id, title, description, region_id, order_in_story, unlock_requirements, reward_cc, reward_item, mission_difficulty, is_battle, trainer_id"),r.from("player_mission_progress").select("user_id, mission_id, is_completed, completed_at, completion_date, rewards").eq("user_id",o),r.from("achievements").select("id, name, description, icon_url, criteria_json, reward_cc, reward_item"),r.from("user_achievements").select("id, user_id, achievement_id, achievement_name, description, date_earned, unlocked_at, notified_followers, track_id").eq("user_id",o),r.from("player_faction_bonds").select("user_id, faction, bond_amount").eq("user_id",o),r.from("battles").select("player1_id, player2_id, winner_id, battle_log, started_at, ended_at").or("player1_id.eq.".concat(o,",player2_id.eq.").concat(o)),r.from("player_trainer_stats").select("user_id, trainer_id, wins, losses, familiarity, last_battle_at").eq("user_id",o),r.from("player_stats").select("user_id, stat_key, stat_value").eq("user_id",o),r.from("creature_stage_xp_thresholds").select("id, creature_id, stage_id, xp_required, created_at, updated_at"),r.from("factions").select("id, name, description, color_hex, icon_url, slug, motto, alignment, lore_json")]),P=(t,r)=>{if(!r)return;let s="string"==typeof(null==r?void 0:r.message)?r.message:String(r);e.push("".concat(t,": ").concat(s))};P("profiles",t.error),P("creatures",s.error),P("creature_stages",a.error),P("player_creatures",i.error),P("regions",n.error),P("region_creatures",d.error),P("cities",l.error),P("city_creatures",u.error),P("story_missions",_.error),P("player_mission_progress",f.error),P("achievements",g.error),P("user_achievements",y.error),P("player_faction_bonds",x.error),P("battles",S.error),P("player_trainer_stats",b.error),P("player_stats",k.error),P("creature_stage_xp_thresholds",N.error),P("factions",O.error),t.data&&U(t.data),s.data&&v(s.data),a.data&&j(a.data.map(e=>{var t;return{...e,stage_stats:"string"==typeof e.stage_stats?JSON.parse(e.stage_stats):null!==(t=e.stage_stats)&&void 0!==t?t:{hp:0,atk:0,def:0,speed:0,faith:0}}})),i.data&&w(i.data),n.data&&p(n.data),d.data&&C(d.data),l.data&&h(l.data),u.data&&q(u.data),_.data&&A(_.data),f.data&&T(f.data),g.data&&E(g.data),y.data&&B(y.data),x.data&&M(x.data),S.data&&Z(S.data),b.data&&L(b.data),k.data&&z(k.data),N.data&&Q(N.data),O.data&&W(O.data),H(!0),e.length?(c("error"),m(e.join(" | "))):c("ready")};(0,a.useEffect)(()=>{"ready"===l&&Y()},[l,o]);let $=(0,a.useMemo)(()=>({regions:f,creatures:y,creatureStages:x,playerCreatures:S,regionCreatures:b,cityCreatures:k,missions:N,missionProgress:O,achievements:P,userAchievements:I,bonds:D,battles:R,profile:G,trainerStats:J,playerStats:X,xpThresholds:K,factions:V,cities:g,status:u,error:_,isLive:F,reload:Y}),[f,y,x,S,b,N,O,P,I,D,R,G,J,X,K,V,u,_,F]);return(0,s.jsx)(d.Provider,{value:$,children:t})}function l(){return(0,a.useContext)(d)}},1180:function(e,t,r){"use strict";r.d(t,{O:function(){return i}});var s=r(3234);let a=null;function i(){if(a)return a;let e="https://npdklestjuejrotjtqwt.supabase.co",t="sb_publishable_9xEllkhUFl85xTTXtDDT5g_ei508t0r";return e&&t?a=(0,s.eI)(e,t,{auth:{persistSession:!0,autoRefreshToken:!0}}):null}}},function(e){e.O(0,[234,971,23,744],function(){return e(e.s=4539)}),_N_E=e.O()}]);